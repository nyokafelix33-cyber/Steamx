<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>FENG WORLD StreamVault</title>

<link rel="manifest" href="manifest.json">
<link rel="icon" href="icons/feng-logo.png">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#000;color:white}

/* NAVBAR */
nav{
position:fixed;top:0;width:100%;
display:flex;align-items:center;justify-content:space-between;
padding:15px 20px;background:linear-gradient(#000,#000000aa);
z-index:999;
}
.logo{font-size:22px;font-weight:bold;color:#d3f243}
nav input{padding:8px;background:#111;border:none;color:white;border-radius:6px}

/* HERO */
#hero{
height:90vh;background-size:cover;background-position:center;
display:flex;flex-direction:column;justify-content:end;padding:50px;
}
#hero h1{font-size:45px}
.hero-btns button{
padding:12px 20px;margin-right:10px;border:none;font-weight:bold;border-radius:5px;
cursor:pointer
}
.play{background:#d3f243;color:black}
.info{background:#333;color:white}

/* ROWS */
.row{padding:20px}
.row h2{margin-bottom:10px}
.row-list{display:flex;overflow-x:auto;gap:10px}
.card{
min-width:150px;cursor:pointer;transition:.3s;
}
.card:hover{transform:scale(1.1)}
.card img{width:150px;border-radius:8px}

/* MODAL */
#modal{
position:fixed;inset:0;background:#000c;
display:none;align-items:center;justify-content:center;
}
.modal-box{
background:#111;padding:20px;width:90%;max-width:600px;border-radius:12px
}
button{cursor:pointer}

/* WATCHLIST */
.watch{color:#d3f243;font-size:14px;cursor:pointer}
</style>
</head>

<body>

<!-- NAVBAR -->
<nav>
<div class="logo">FENG WORLD</div>
<input placeholder="Search movies..." oninput="search(this.value)">
</nav>

<!-- HERO -->
<div id="hero">
<h1 id="hero-title"></h1>
<div class="hero-btns">
<button class="play" onclick="playHero()">‚ñ∂ Play</button>
<button class="info" onclick="openModal(heroData[currentHero].id,heroData[currentHero].media_type)">‚Ñπ Info</button>
</div>
</div>

<!-- CONTENT ROWS -->
<div class="row"><h2>üî• Trending Now</h2><div id="trending" class="row-list"></div></div>
<div class="row"><h2>üé¨ Popular Movies</h2><div id="movies" class="row-list"></div></div>
<div class="row"><h2>üì∫ TV Shows</h2><div id="series" class="row-list"></div></div>
<div class="row"><h2>‚≠ê My Watchlist</h2><div id="watchlist" class="row-list"></div></div>

<!-- MODAL -->
<div id="modal">
<div class="modal-box">
<h2 id="m-title"></h2>
<p id="m-desc"></p>
<p id="m-rate"></p>
<span class="watch" onclick="addWatchlist()">+ Add to Watchlist</span><br><br>
<button onclick="watchTrailer()">Watch Trailer</button>
<button onclick="closeModal()">Close</button>
</div>
</div>

<script>
const KEY="ea593c3fa4d4942ece315977cd7e32c9";
let heroData=[],currentHero=0,trailerKey="",currentItem=null;
let watchlist=JSON.parse(localStorage.getItem("watchlist")||"[]");

/* HERO */
async function loadHero(){
let r=await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${KEY}`);
let d=await r.json();
heroData=d.results.slice(0,5);
setHero();
setInterval(()=>{currentHero=(currentHero+1)%heroData.length;setHero();},6000);
}
function setHero(){
let m=heroData[currentHero];
document.getElementById("hero").style.backgroundImage=`linear-gradient(#000000aa,#000000aa),url(https://image.tmdb.org/t/p/original${m.backdrop_path})`;
document.getElementById("hero-title").innerText=m.title||m.name;
}
function playHero(){
alert("Real streaming player coming soon üòé");
}

/* ROWS */
async function loadRow(url,id){
let r=await fetch(url);
let d=await r.json();
let html="";
d.results.forEach(m=>{
if(!m.poster_path)return;
html+=`<div class="card" onclick="openModal(${m.id},'${m.media_type||'movie'}')">
<img src="https://image.tmdb.org/t/p/w300${m.poster_path}">
</div>`;
});
document.getElementById(id).innerHTML=html;
}

/* MODAL */
async function openModal(id,type){
currentItem={id,type};
let r=await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${KEY}&append_to_response=videos`);
let d=await r.json();
document.getElementById("m-title").innerText=d.title||d.name;
document.getElementById("m-desc").innerText=d.overview;
document.getElementById("m-rate").innerText="‚≠ê "+d.vote_average;

trailerKey="";
if(d.videos && d.videos.results.length){
let t=d.videos.results.find(v=>v.type=="Trailer");
if(t) trailerKey=t.key;
}

document.getElementById("modal").style.display="flex";
}

/* WATCHLIST */
function addWatchlist(){
if(!watchlist.find(x=>x.id==currentItem.id)){
watchlist.push(currentItem);
localStorage.setItem("watchlist",JSON.stringify(watchlist));
loadWatchlist();
alert("Added to My List");
}
}
async function loadWatchlist(){
let html="";
for(let w of watchlist){
let r=await fetch(`https://api.themoviedb.org/3/${w.type}/${w.id}?api_key=${KEY}`);
let d=await r.json();
html+=`<div class="card"><img src="https://image.tmdb.org/t/p/w300${d.poster_path}"></div>`;
}
document.getElementById("watchlist").innerHTML=html;
}

/* SEARCH */
async function search(q){
if(q.length<3)return;
let r=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${KEY}&query=${q}`);
let d=await r.json();
let html="";
d.results.forEach(m=>{
if(m.poster_path){
html+=`<div class="card" onclick="openModal(${m.id},'${m.media_type}')">
<img src="https://image.tmdb.org/t/p/w300${m.poster_path}">
</div>`;
}
});
document.getElementById("movies").innerHTML=html;
}

/* TRAILER */
function watchTrailer(){
if(trailerKey) window.open(`https://youtube.com/watch?v=${trailerKey}`);
}

/* CLOSE */
function closeModal(){document.getElementById("modal").style.display="none";}

/* INIT */
loadHero();
loadRow(`https://api.themoviedb.org/3/trending/movie/week?api_key=${KEY}`,"trending");
loadRow(`https://api.themoviedb.org/3/movie/popular?api_key=${KEY}`,"movies");
loadRow(`https://api.themoviedb.org/3/tv/popular?api_key=${KEY}`,"series");
loadWatchlist();

/* PWA */
if('serviceWorker' in navigator){navigator.serviceWorker.register("sw.js");}
</script>

</body>
</html>
